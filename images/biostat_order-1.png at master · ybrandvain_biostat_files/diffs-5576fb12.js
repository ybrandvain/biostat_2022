System.register(["./chunk-vendor.js","./chunk-frameworks.js","./chunk-input-demux.js","./chunk-ref-selector.js"],function(){"use strict";var b,f,C,le,ut,ae,I,M,de,ft,X,ue,V,mt,$,U,fe,me,G,J,gt,pt,ge,ht,P,pe,bt,yt,he,Y,Z,vt,St,jt,wt,At,Lt,qt,_t,xt;return{setters:[function(g){b=g.o,f=g.a,C=g.r,le=g.e,ut=g.I,ae=g.f,I=g.t,M=g.b,de=g.c},function(g){ft=g._,X=g.z,ue=g.aK,V=g.G,mt=g.c,$=g.ax,U=g.q,fe=g.S,me=g.e,G=g.aL,J=g.y,gt=g.aM,pt=g.aN,ge=g.aO,ht=g.aP,P=g.aw,pe=g.aQ,bt=g.D,yt=g.s,he=g.B,Y=g.aq,Z=g.ao,vt=g.j,St=g.u,jt=g.a7,wt=g.a2,At=g.aR,Lt=g.aS,qt=g.aT,_t=g.aU,xt=g.g},function(){},function(){}],execute:function(){var g=Object.defineProperty,En=(t,e)=>g(t,"name",{value:e,configurable:!0});b("#js-spoof-warning-placeholder",{add:En(()=>{const t=document.getElementById("spoof-warning");if(!t)return;document.querySelector(".commit-title").classList.add("pb-1"),t.hidden=!1,t.removeAttribute("aria-hidden")},"showSpoofCommitBanner")});var kn=Object.defineProperty,Fn=(t,e)=>kn(t,"name",{value:e,configurable:!0});f("click",".js-conversation-menu-button",function(){let t=!0;return async function(e){if(t===!1){const o=e.currentTarget.closest(".select-menu").querySelector("details-menu");if(!o)return;o.innerHTML="";const r=`${o.getAttribute("src")}?instrument=1`,i=await fetch(r);i.ok&&(o.innerHTML=await i.text())}t=!1}}()),f("click",".js-conversations-menu-item",function(t){const e=t.currentTarget,n=e.closest(".js-conversations-details");n.hasAttribute("open")&&n.removeAttribute("open"),window.location.hash=e.hash,ft(document)}),f("click",".js-resolved-conversations",async function(t){const e=t.currentTarget.querySelector(".dropdown-caret"),n=t.currentTarget.querySelector(".select-menu-header");Ct(e),n.classList.toggle("border-bottom-0")});function Ct(t){t.style.transform===""?t.style.transform="rotate(180deg)":t.style.transform=""}Fn(Ct,"flipCaret");var In=Object.defineProperty,Pn=(t,e)=>In(t,"name",{value:e,configurable:!0});function be(t,e,n,s,o,r,i,c){const d=document.querySelector(".js-file-filter"),a=new URL(window.location.href,window.location.origin);if(!t&&!s)return e||r?void 0:(a.search="",X(ue(),"",a.toString()));const l=d.querySelector(".js-file-filter-form"),m=new FormData(l),h=n.filter(u=>!m.getAll("file-filters[]").includes(u)),y=o.filter(u=>!m.getAll("owned-by[]").includes(u));for(const u of h)m.append("file-filters[]",u);for(const u of y)m.append("owned-by[]",u);const p=new URLSearchParams(m);(!p.has("file-filters[]")||p.toString()==="")&&p.set("file-filters[]",""),e&&p.set("w","1"),r&&p.set("manifests","true"),i&&p.set("show-deleted-files","false"),c&&p.set("show-viewed-files","false"),p.delete("authenticity_token"),a.search=p.toString(),X(ue(),"",a.toString())}Pn(be,"updateURLState");var On=Object.defineProperty,v=(t,e)=>On(t,"name",{value:e,configurable:!0});f("details:toggled-group",".js-file.js-details-container",function(t){t.target===t.currentTarget&&Et(t.detail.open)}),f("details:toggled",".js-file.js-details-container",function(t){if(t.target!==t.currentTarget)return;const e=t.currentTarget;e.getBoundingClientRect().top<0&&$(e)}),V(()=>{const t=window.location.hash.slice(1);if(!t)return;const e=document.getElementsByName(t)[0];if(!e)return;const n=e.nextElementSibling;n&&n.matches(".js-file.js-details-container")&&(n.classList.add("open"),n.classList.add("Details--on"))}),b(".js-file-header-dropdown",{subscribe:t=>mt(t,"toggle",Tt)});function Tt({currentTarget:t}){const e=t,n=e.hasAttribute("open");e.closest(".js-file-header").classList.toggle("has-open-dropdown",n)}v(Tt,"toggleFileHeaderMenu");function Et(t){if(!document.querySelector(".js-file-filter"))return;const n=W();for(const r of n)r.checked=t;const s=ve();s&&(s.checked=!t);const o=kt();It(o),Pt(o),Mt(),Ot(),Bt(),be(o,Ft(),ye(),Se(),je(),Ae(),z(),Le())}v(Et,"toggledAllFileContents");function ye(){return Array.from(W()).filter(e=>e.checked).map(e=>e.value)}v(ye,"getSelectedFileTypes");function W(){return document.querySelectorAll(".js-diff-file-type-option")}v(W,"getFileTypeOptions");function ve(){const t=document.querySelector(".js-deleted-files-toggle");if(t instanceof HTMLInputElement)return t}v(ve,"getDeletedFilesInput");function kt(){return we()||z()||Le()||Se()||Ae()}v(kt,"fileFilterActive");function Se(){return je().length>0}v(Se,"codeownerFilterActive");function je(){const t=document.querySelectorAll(".js-diff-owner-option");return Array.from(t).filter(n=>n.checked).map(n=>n.value)}v(je,"getSelectedOwners");function we(){return ye().length!==W().length}v(we,"fileTypeFilterActive");function Ae(){const t=document.querySelector(".js-manifests-option");return t?t.checked:!1}v(Ae,"manifestFilterActive");function z(){const t=ve();return t?!t.checked:!1}v(z,"deletedFilterActive");function Le(){const t=document.querySelector(".js-viewed-files-toggle");return t?!t.checked:!1}v(Le,"viewedFilterActive");function Ft(){return new URLSearchParams(window.location.search).has("w")}v(Ft,"whitespaceFilterActive");function It(t){document.querySelector(".js-file-filter-text").classList.toggle("color-fg-accent",t)}v(It,"toggleHighlightActiveFilter");function Pt(t){const e=document.querySelector(".js-reset-filters"),n=document.querySelector(".js-commits-filtered");e!=null&&!n&&(e.hidden=!t)}v(Pt,"toggleResetFileFiltersButton");function Ot(){const t=we(),e=document.querySelector(".js-file-filter-select-all-container"),n=t?"data-select-all-markup":"data-all-selected-markup",s=e.getAttribute(n);e.textContent=s,e.classList.toggle("color-fg-muted",!t),e.classList.toggle("color-fg-accent",t)}v(Ot,"toggleSelectAll");function Mt(){const t=W(),e=z();for(const n of t)if(e){const s=n.getAttribute("data-non-deleted-files-count")==="0";n.disabled=s}else n.disabled=!1}v(Mt,"toggleAvailableOptions");function Bt(){const t=document.querySelectorAll(".js-file-type-count");for(const e of t){const n=z()?"data-non-deleted-file-count-markup":"data-all-file-count-markup",s=e.getAttribute(n);s&&(e.textContent=s)}}v(Bt,"toggleFileTypeCounts");var Mn=Object.defineProperty,Bn=(t,e)=>Mn(t,"name",{value:e,configurable:!0});function qe(){const t=document.querySelector(".js-file-filter-blankslate");if(!t)return;if(document.querySelectorAll(".js-diff-progressive-loader").length>0){t.hidden=!0;return}const n=document.querySelectorAll(".js-file");if(n.length===0){t.hidden=!0;return}const s=Array.from(n).some(o=>!o.hidden);t.hidden=s}Bn(qe,"checkEmptyFilterResults"),b(".js-diff-progressive-loader",function(t){t.addEventListener("loadend",function(){qe()})}),f("click",".js-jump-to-menu-item",function({currentTarget:t}){const e=t.getAttribute("href").substring(1),n=document.querySelector(`[data-anchor="${e}"]`);if(n){const s=n.closest(".js-file.js-details-container");s.hidden=!1}qe()});var Rn=Object.defineProperty,B=(t,e)=>Rn(t,"name",{value:e,configurable:!0});const _e="```suggestion",ee="```",Hn=new RegExp(`${_e}(?:.*)
`,"i"),$n=new RegExp(`${ee}(
|$)`);function xe(t,e){const n=t.slice(0,e).split(`
`);return t.split(`
`)[n.length-1]}B(xe,"lineAtIndex");function Ce(t){const n=/^(\s+)/.exec(t);return n&&n[0]||""}B(Ce,"leadingWhitespace");function Rt(t){let e=`${_e}
`;return e+=`${t}
`,e+=ee,e}B(Rt,"formatSuggestion");function K(t,e,n=0){const s=e.substring(n,e.length),o=t.exec(s);return o?o.index+n:-1}B(K,"findNextOccurrenceOf");function Te(t,e){const n=[];let s=0,o=-1;for(;(o=K(Hn,t,s))>-1;){s=o+_e.length;const r=K($n,t,s);if(r===-1)return!1;s=r+ee.length,n.push([o,r])}return n.some(r=>e>r[0]&&e<r[1])}B(Te,"cursorInSuggestionBlock");function Ht(t){const e=t.selectionStart;if(!Te(t.value,e))return!1;const n=t.value,s=xe(n,e);if(s===null)return!1;const r=`
${Ce(s)}`,i=n.substr(0,e)+r+n.substr(e);U(t,i);const c=e+r.length;return t.setSelectionRange(c,c),!0}B(Ht,"insertNewSuggestionLine");function $t(t,e){const n=Rt(t),s=e.selectionStart,o=e.value,r=K(/\n/,o,s),i=o.trim()==="",c=xe(o,s),d=c.trim()==="",a=`
${ee}`.length;let l=o,m=0;if(i)l=n,m=l.length-a;else if(r===-1)d?(l=o+n,m=l.length-a):(l=[o,n].join(`
`),m=l.length-a);else if(d){const h=Ce(c),y=s-h.length,p=o.substring(0,y),u=o.substring(r,o.length);l=[p,n,u].join(""),m=l.length-u.length-a}else if(Te(o,s)){const h=K(/```/,o,s)+3,y=o.substring(0,h),p=o.substring(h,o.length);l=[y,`
`,n,p].join(""),m=l.length-p.length-a}else{const h=o.substring(0,r),y=o.substring(r,o.length);l=[h,`
`,n,y].join(""),m=l.length-y.length-a}U(e,l),e.focus(),e.setSelectionRange(m,m)}B($t,"insertSuggestionBlock");var Dn=Object.defineProperty,E=(t,e)=>Dn(t,"name",{value:e,configurable:!0});const L={addToBatchEnabled:".js-add-to-batch-enabled",unchangedSuggestion:".js-unchanged-suggestion",closedOrMergedPull:".js-closed-pull",viewingSubset:".js-viewing-subset-changes",leftBlob:".js-validation-on-left-blob",rightBlob:".js-validation-on-right-blob",outdatedComment:".js-outdated-comment",resolvedThread:".js-resolved-thread",pendingReview:".js-pending-review",isMultiLine:".js-is-multiline"};function Dt(t){const e=t.getAttribute("data-lines");if(e!=null){const s=t.closest(".js-suggested-changes-container").querySelector(".js-comment-field");$t(e,s)}}E(Dt,"renderSuggestionBlock");function Ee(t,e){const n=document.querySelectorAll(".js-apply-suggestion-button"),s=t.querySelector(".js-disabled-apply-suggestion-button");for(const o of n){const r=s.cloneNode(!0);O(r,e),o.closest("details").replaceWith(r)}}E(Ee,"disableAllApplySuggestionButtons");function ke(t){const e=document.querySelector(".js-batched-suggested-changes-container");e&&e.classList.add("d-none");for(const n of document.querySelectorAll(".js-apply-single-suggestion"))n.classList.remove("d-none"),n.disabled=!0,n.setAttribute("aria-label",t);for(const n of document.querySelectorAll(".js-batched-suggested-changes-add"))n.classList.remove("d-none"),n.disabled=!0,n.setAttribute("aria-label",t);for(const n of document.querySelectorAll(".js-batched-suggested-changes-remove"))n.classList.add("d-none");for(const n of document.querySelectorAll(".js-focus-commit-suggestions-form-button"))n.classList.add("d-none");for(const n of document.querySelectorAll(".js-pending-batched-suggestion-label"))n.classList.add("d-none")}E(ke,"disableBatchSuggestionsButtons");function O(t,e){t.setAttribute("aria-label",e),t.classList.remove("d-none")}E(O,"displayButton");function te(t,e){const n=document.querySelector(".js-suggested-changes-inline-validation-template").cloneNode(!0);n.classList.remove("js-suggested-changes-inline-validation-template");const s=n.querySelector(".js-suggested-changes-inline-error-message");s.textContent=t.trim(),e.parentNode.insertBefore(n,e.nextSibling)}E(te,"validateOnPreview"),f("click",".js-suggested-change-toolbar-item",function(t){const e=t.currentTarget;e instanceof HTMLButtonElement&&!e.disabled&&Dt(e)}),f("click",".js-refresh-after-suggestion",function(){window.location.reload()});function Fe(t){if(!document.querySelector(".js-suggested-changes-subset-files"))return;const n=t.querySelectorAll(".js-suggested-change-toolbar-item"),s=L.viewingSubset,o=document.querySelector(s).textContent.trim();for(const r of n)r.disabled=!0,r.setAttribute("aria-label",o)}E(Fe,"validateInlineCommmentsContainer"),b(".js-inline-comments-container",{add(t){Fe(t)}}),b(".js-preview-body .js-apply-changes",{add(t){const e=t.closest(".js-suggested-changes-container");if(!e)return t.remove();const n=document.querySelector(L.rightBlob).textContent,s=document.querySelector(L.leftBlob).textContent,o=t.closest(".js-suggested-changes-blob");if(e.getAttribute("data-thread-side")!==""){if(e.getAttribute("data-thread-side")==="left")return te(s,o),t.remove()}else{const l=t.closest(".js-inline-comment-form"),m=l.querySelector('input[name="side"]');if(!l||!m)return t.remove();if(l&&m.value==="left")return te(s,o),t.remove()}const r=t.previousElementSibling,i=r.querySelector(".js-blob-code-deletion"),c=r.querySelectorAll(".js-blob-code-addition");if(!i||c.length===0)return;const d=i.textContent,a=Array.from(c).map(l=>l.textContent);if(d===a.join(`
`))return te(n,o),t.remove();t.remove()}}),b(".js-comment-body .js-apply-changes",{add(t){const e=t.closest(".js-suggested-changes-container");if(!e)return t.remove();const n=e.querySelector(".js-suggested-changes-template");if(!(n instanceof HTMLTemplateElement))return t.remove();const s=n.content.cloneNode(!0),o=s.querySelector(".js-disabled-apply-suggestion-button");let r;try{r=s.querySelector(".js-batched-suggested-changes-add")}catch(u){if(u.name!=="QueryError")throw u}if(document.querySelectorAll(".js-suggested-changes-files-tab").length){const u=document.querySelector(L.addToBatchEnabled).textContent;r&&(r.removeAttribute("disabled"),r.setAttribute("aria-label",u))}const i=document.querySelector(".js-pull-header-details"),c=i&&i.getAttribute("data-pull-is-open")==="true",d=t.closest(".js-resolvable-timeline-thread-container"),a=n.getAttribute("data-comment-pending")==="true",l=e.classList.contains("js-selection-contains-deletions");if(d&&d.getAttribute("data-resolved")==="true"){const u=document.querySelector(L.resolvedThread).textContent,w=s.querySelector("details");return w&&w.remove(),O(o,u),r&&(r.setAttribute("disabled","disabled"),r.setAttribute("aria-label",u)),t.replaceWith(s)}if(!c){const u=document.querySelector(L.closedOrMergedPull).textContent;return O(o,u),r&&(r.setAttribute("disabled","disabled"),r.setAttribute("aria-label",u)),t.replaceWith(s)}if(a){const u=document.querySelector(L.pendingReview).textContent;return s.querySelector("details").remove(),O(o,u),r&&(r.setAttribute("disabled","disabled"),r.setAttribute("aria-label",u)),t.replaceWith(s)}if(l){const u=document.querySelector(L.leftBlob).textContent;return s.querySelector("details").remove(),O(o,u),r&&(r.setAttribute("disabled","disabled"),r.setAttribute("aria-label",u)),t.replaceWith(s)}const m=document.querySelector(".js-suggested-changes-subset-files"),h=n.getAttribute("data-outdated-comment")==="true";if(m||h){let u;return m?u=document.querySelector(L.viewingSubset).textContent:h&&(u=document.querySelector(L.outdatedComment).textContent),s.querySelector("details").remove(),O(o,u),r&&(r.setAttribute("disabled","disabled"),r.setAttribute("aria-label",u)),t.replaceWith(s)}const y=s.querySelector(".js-single-suggested-change-form"),p=t.closest(".js-suggested-changes-blob");if(p){const u=p.querySelector(".js-blob-code-deletion"),w=p.querySelectorAll(".js-blob-code-addition");if(!u)return;const _=u.textContent,F=Array.from(w).map(T=>T.textContent);if(F.length>0&&_===F.join(`
`)){const T=document.querySelector(L.unchangedSuggestion).textContent;s.querySelector("details").remove(),O(o,T),r&&(r.setAttribute("disabled","disabled"),r.setAttribute("aria-label",T))}else for(const T of F){const N=document.createElement("input");N.setAttribute("type","hidden"),N.setAttribute("name","value[]"),N.value=T,y.appendChild(N)}}t.replaceWith(s)}}),b(".js-pull-header-details",{add(t){const e=t.getAttribute("data-pull-is-open")==="true",n=document.querySelector(".js-suggested-changes-template");if(e||!(n instanceof HTMLTemplateElement))return;const s=n.content,o=document.querySelector(L.closedOrMergedPull).textContent;Ee(s,o),ke(o)}}),b(".js-suggested-changes-subset-files",{add(){const t=document.querySelector(".js-suggested-changes-template");if(!(t instanceof HTMLTemplateElement))return;const e=t.content,n=document.querySelector(L.viewingSubset).textContent;Ee(e,n),ke(n)}}),f("click",".js-apply-suggestion-button",async function(t){const e=t.currentTarget.parentElement;if(e){const n=e.querySelector(".js-suggestion-commit-title");setTimeout(()=>n.focus(),1)}}),f("click",".js-dismiss-suggested-change-onboarding-notice",async function(t){const e=t.currentTarget.getAttribute("data-url"),n=t.currentTarget.parentElement.querySelector(".js-data-url-csrf"),s=new FormData;if(s.append("notice","suggested_changes_onboarding_prompt"),(await fetch(e,{method:"POST",mode:"same-origin",body:s,headers:{"Scoped-CSRF-Token":n.value,"X-Requested-With":"XMLHttpRequest"}})).ok){const r=document.querySelectorAll(".js-suggested-change-onboarding-notice");for(const i of r)i.remove()}}),fe("keypress",".js-comment-field",function(t){if(t.key==="Enter"){const e=t.target;Ht(e)&&t.preventDefault()}}),fe("keypress",".js-suggestion-commit-message",function(t){const e=t.currentTarget;t.key==="Enter"&&e.setAttribute("rows","3")});function Nt(t){const n=t.closest(".js-review-state-classes").querySelectorAll("[data-pending-batched-suggestion]").length;for(const o of document.querySelectorAll(".js-pending-batched-suggested-changes-count"))o.textContent=String(n);const s=document.querySelector(".js-reenable-add-to-batch").textContent;for(const o of document.querySelectorAll("[data-batched-suggestion-reenable-sibling]"))o.removeAttribute("data-batched-suggestion-reenable-sibling"),o.removeAttribute("disabled"),o.setAttribute("aria-label",s);if(n>0){t.hidden=!1;const o=t.querySelector(".js-batched-suggested-changes-toggle");o.classList.add("anim-pulse-in"),o.addEventListener("animationend",()=>o.classList.remove("anim-pulse-in"),{once:!0});for(const r of document.querySelectorAll(".js-apply-single-suggestion"))r.classList.add("d-none");for(const r of document.querySelectorAll(".js-batched-suggested-changes-add")){const i=r.closest(".js-suggested-change-form-container");i.getAttribute("data-pending-batched-suggestion")==="true"||i.getAttribute("data-comment-pending")==="true"||i.getAttribute("data-outdated-comment")==="true"?r.classList.add("d-none"):r.classList.remove("d-none"),r.getAttribute("data-batched-suggestion-disabled-by-sibling")==="true"&&(r.removeAttribute("data-batched-suggestion-disabled-by-sibling"),r.setAttribute("disabled","disabled"),r.setAttribute("aria-label",document.querySelector(".js-one-suggestion-per-line").textContent))}for(const r of document.querySelectorAll(".js-batched-suggested-changes-remove"))r.closest(".js-suggested-change-form-container").getAttribute("data-pending-batched-suggestion")==="true"?r.classList.remove("d-none"):r.classList.add("d-none");for(const r of document.querySelectorAll(".js-focus-commit-suggestions-form-button")){const i=r.closest(".js-suggested-change-form-container"),c=i.getAttribute("data-comment-pending")==="true",d=i.getAttribute("data-outdated-comment")==="true",a=i.getAttribute("data-resolved-comment")==="true",h=r.closest(".js-inline-comments-container").querySelector('input[name="side"]').value==="left";c||d||a||h?r.classList.add("d-none"):r.classList.remove("d-none")}for(const r of document.querySelectorAll(".js-pending-batched-suggestion-label"))r.closest(".js-suggested-change-form-container").getAttribute("data-pending-batched-suggestion")==="true"?r.classList.remove("d-none"):r.classList.add("d-none")}else{t.hidden=!0;for(const o of document.querySelectorAll(".js-apply-single-suggestion"))o.classList.remove("d-none");for(const o of document.querySelectorAll(".js-batched-suggested-changes-add"))o.classList.remove("d-none");for(const o of document.querySelectorAll(".js-batched-suggested-changes-remove"))o.classList.add("d-none");for(const o of document.querySelectorAll(".js-focus-commit-suggestions-form-button"))o.classList.add("d-none");for(const o of document.querySelectorAll(".js-pending-batched-suggestion-label"))o.classList.add("d-none")}}E(Nt,"updatePendingSuggestionsState");function Ie(){const t=document.querySelector(".js-batched-suggested-changes-container");t&&setTimeout(()=>Nt(t))}E(Ie,"updatePendingSuggestionsHandler"),f("click",".js-batched-suggested-changes-add",function(t){const e=t.target,n=e.closest(".js-suggested-change-form-container");if(n.getAttribute("data-comment-pending")==="true"||n.getAttribute("data-outdated-comment")==="true"||e.getAttribute("data-batched-suggestion-disabled-by-sibling")==="true")return;n.setAttribute("data-pending-batched-suggestion","true");const s=e.closest(".js-inline-comments-container");for(const o of s.querySelectorAll(".js-batched-suggested-changes-add"))o.setAttribute("data-batched-suggestion-disabled-by-sibling","true");e.removeAttribute("data-batched-suggestion-disabled-by-sibling"),Ie()}),f("click",".js-batched-suggested-changes-remove",function(t){t.currentTarget.closest(".js-suggested-change-form-container").removeAttribute("data-pending-batched-suggestion");const n=t.currentTarget.closest(".js-inline-comments-container");for(const s of n.querySelectorAll(".js-batched-suggested-changes-add"))s.setAttribute("data-batched-suggestion-reenable-sibling","true");Ie()}),f("click",".js-focus-commit-suggestions-form-button",function(t){t.preventDefault(),window.location.href="#clear-commit-suggestions",window.location.href="#commit-suggestions"}),f("click",".js-dismiss-batched-suggested-changes-onboarding-notice",async function(t){const e=t.currentTarget.getAttribute("data-url"),n=t.currentTarget.parentElement.querySelector(".js-data-url-csrf"),s=new FormData;if(s.append("notice","batched_suggested_changes_onboarding_prompt"),(await fetch(e,{method:"POST",mode:"same-origin",body:s,headers:{"Scoped-CSRF-Token":n.value,"X-Requested-With":"XMLHttpRequest"}})).ok)for(const r of document.querySelectorAll(".js-batched-suggested-change-onboarding-notice"))r.remove()});function Pe(t,e){const n=t.querySelector("input[name=commit_title]"),s=t.querySelector("textarea[name=commit_message]");let o=n.value.trim();o===""&&(o=n.defaultValue);const r=s.value.trim();r!==""&&(o=`${o}

${r}
`),n.disabled=!0,s.disabled=!0;const i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","message"),i.value=o,t.appendChild(i);const c=document.createElement("input");c.setAttribute("type","hidden"),c.setAttribute("name","changes"),c.value=JSON.stringify(e),t.appendChild(c)}E(Pe,"convertFormInputs"),f("click",".js-single-suggested-change-form .js-suggested-changes-submit",function(t){const n=t.currentTarget.closest(".js-single-suggested-change-form"),s=Array.from(n.querySelectorAll('input[name="value[]"]')).map(r=>r.value),o=[{commentId:n.querySelector("input[name=comment_id]").value,path:n.querySelector("input[name=path]").value,suggestion:s}];Pe(n,o)}),C(".js-single-suggested-change-form",async function(t,e){const n=t.closest(".js-suggested-change-form-container"),s=t.closest("details"),o=n.querySelector(".js-suggestion-applied"),i=t.closest(".js-suggested-changes-contents").querySelector(".js-error-message-placeholder");try{await e.json(),o.classList.remove("d-none"),n.querySelector(".js-batched-suggested-changes-add").classList.add("d-none"),s.remove(),window.location.reload()}catch(c){if(c.name!=="QueryError"){const d=c.response.json&&c.response.json.error,a=i.querySelector(".js-error-message");i.hidden=!1,a.textContent=d,n.prepend(i),t.closest(".js-suggested-change-form-container").querySelector(".js-batched-suggested-changes-add").classList.add("d-none"),s.remove()}}}),f("click",".js-suggestion-batch-submit",function(t){const e=t.currentTarget.closest(".js-batched-suggested-changes-form"),n=[];for(const s of document.querySelectorAll("[data-pending-batched-suggestion]")){const o=s.querySelector(".js-single-suggested-change-form"),r=Array.from(o.querySelectorAll('input[name="value[]"]')).map(i=>i.value);n.push({commentId:o.querySelector("input[name=comment_id]").value,path:o.querySelector("input[name=path]").value,suggestion:r})}Pe(e,n)}),C(".js-batched-suggested-changes-form",async function(t,e){try{await e.json();const n=t.closest(".js-batched-suggested-changes-container");n.hidden=!0,window.location.reload()}catch(n){const s=n.response.json&&n.response.json.error,r=t.closest(".js-batched-suggested-changes-container").querySelector(".js-error-message-container"),i=r.querySelector(".js-error-message");i.textContent=s,r.hidden=!1}}),b(".js-files-tab-stale",{add(){const t=document.querySelector(".js-batched-suggested-changes-container");t&&setTimeout(()=>{t.hidden=!0})}});var Nn=Object.defineProperty,S=(t,e)=>Nn(t,"name",{value:e,configurable:!0});let Vn=0;f("click",".js-add-single-line-comment",function(t){const e=t.currentTarget,n=e.closest(".file");Be(n);const s=Vt(e)||Ut(e),o=Me(s.querySelector("td"),e),r=o.querySelector(".js-inline-comment-form");r instanceof HTMLFormElement&&De(r,e),G(o)});function Vt(t){const e=t.closest("tr"),n=Oe(e,".js-inline-comments-container");if(n instanceof Element)return n}S(Vt,"existingCommentRow");function Oe(t,e){const n=t.nextElementSibling;return n&&n.matches(e)?n:null}S(Oe,"next");function Ut(t){const e=t.closest("tr"),n=ne("js-inline-comments-single-container-template",t).firstElementChild;return e.after(n),n}S(Ut,"insertCommentRow");function Me(t,e){const n=Array.from(t.querySelectorAll(".review-comment-form-container:not(.open)")).pop();if(n)return n.closest("div.js-line-comments");{const s=ne("js-inline-comments-single-container-template",e).querySelector("div.js-line-comments");return t.appendChild(s),s}}S(Me,"findOrInsertCommentThread"),f("click",".js-add-split-line-comment",function(t){const e=t.currentTarget,n=e.closest(".file");Be(n);const s=e.closest("tr"),o=e.getAttribute("data-type")==="addition"?"js-addition":"js-deletion",r=Jt(s),i=Gt(r,o,e),c=Me(i,e),d=c.querySelector(".js-inline-comment-form");d instanceof HTMLFormElement&&De(d,e),G(c)}),C(".js-inline-comment-form",async function(t,e){Wt(t);let n;try{n=await e.json()}catch(c){if(c.response){let d;try{d=c.response.json}catch(a){}if(d){zt(t,d);return}}throw c}const s=n.json,o=s.inline_comment,r=t.closest(".js-line-comments");o&&r.querySelector(".js-comments-holder").append(J(document,o));const i=s.inline_comment_thread;i&&r.replaceWith(J(document,i)),gt(t)});function Wt(t){const e=t.querySelector(".js-comment-form-error");e&&(e.hidden=!0,e.textContent=null)}S(Wt,"resetInlineCommentError");function zt(t,e){const n=t.querySelector(".js-comment-form-error");let s;e.errors?Array.isArray(e.errors)?s=e.errors.join(", "):s=e.errors:s="There was an error posting your comment.",n.textContent=s,n.style.display="block",n.hidden=!1,n.classList.remove("d-none")}S(zt,"handleInlineCommentError");function Kt(t){const[e,n]=t.match(/^new_inline_comment_(?:discussion|diff)_(?:[\w-]+)_(\d+)_(\d+)$/)||[];if(!e)return;const s=document.querySelector(`.js-inline-comment-form input[name='in_reply_to'][value='${n}']`);if(!s)return;const o=s.closest(".js-line-comments");o&&G(o)}S(Kt,"showReplyForm");function Qt(t){const[e,n]=t.match(/^new_inline_comment_diff_(?:[\w-]+)_(\d+)$/)||[];if(!e)return;const s=document.querySelector(`.js-add-line-comment[data-anchor='${e}'][data-position='${n}']`);s&&s.click()}S(Qt,"showCommentForm"),document.addEventListener("session:resume",function(t){const e=t.detail;Kt(e.targetId),Qt(e.targetId)});function Be(t){const e=t.querySelector(".js-toggle-file-notes");e instanceof HTMLInputElement&&U(e,!0)}S(Be,"ensureInlineNotesEnabled");function Re(){for(const t of document.querySelectorAll(".file .js-inline-comments-container")){const n=t.querySelectorAll(".js-comments-holder > *").length>0,s=t.querySelector(".js-inline-comment-form-container"),o=!!s&&s.classList.contains("open");!n&&!o&&t.remove()}}S(Re,"cleanupInlineCommentContainers"),b(".js-comment",{remove:Re}),f("inlinecomment:focus",".js-inline-comment-form-container",function(t){const e=t.target.querySelector(".js-suggested-changes-container");e&&He(e)}),b(".js-suggested-changes-container.is-comment-editing",t=>{He(t)});function Xt(t,e){const n=new URLSearchParams(t.search.slice(1)),s=e.elements.namedItem("in_reply_to")||e.elements.namedItem("comment_id"),o=e.querySelector("textarea");if(n.append("textarea_id",o.id),s instanceof HTMLInputElement&&s.value)return n.append("comment_id",s.value),n;const r=e.elements.namedItem("path"),i=e.elements.namedItem("start_side"),c=e.elements.namedItem("start_line"),d=e.elements.namedItem("side"),a=e.elements.namedItem("line"),l=e.elements.namedItem("start_commit_oid"),m=e.elements.namedItem("end_commit_oid"),h=e.elements.namedItem("base_commit_oid");return!(r instanceof HTMLInputElement)||!(i instanceof HTMLInputElement)||!(c instanceof HTMLInputElement)||!(d instanceof HTMLInputElement)||!(a instanceof HTMLInputElement)||!(l instanceof HTMLInputElement)||!(m instanceof HTMLInputElement)||!(h instanceof HTMLInputElement)?null:(n.append("path",r.value),n.append("start_side",i.value),n.append("start_line",c.value),n.append("end_side",d.value),n.append("end_line",a.value),n.append("start_commit_oid",l.value),n.append("end_commit_oid",m.value),n.append("base_commit_oid",h.value),n)}S(Xt,"paramsForSuggestionButton");async function He(t){const e=t.querySelector(".js-suggestion-button-placeholder");if(!e)return;const n=e.getAttribute("data-src-base");if(!n)return;const s=new URL(n,window.location.origin),o=e.closest(".js-inline-comment-form")||e.closest(".js-comment-update");if(!(o instanceof HTMLFormElement))return;const r=Xt(s,o);if(!r)return;s.search=r.toString();const i=await me(document,s.toString());e.innerHTML="",e.appendChild(i)}S(He,"loadSuggestionButton"),document.addEventListener("inlinecomment:collapse",()=>{Re()});function Gt(t,e,n){const s=t.querySelector(`.js-line-comments.${e}`);if(s)return s;const o=ne("js-inline-comments-split-form-container-template",n).firstElementChild;o.classList.add(e);const r=t.querySelectorAll(`.${e}`);r[r.length-1].after(o);for(const c of r)c.remove();return o}S(Gt,"expandLineCommentsEmptyCells");function Jt(t){let e=Oe(t,".js-inline-comments-container");if(e)return e;{const n="js-inline-comments-split-container-template",s=document.getElementById(n);if(!s)throw new Error(`Could not find element with id ${n}`);if(!(s instanceof HTMLTemplateElement))throw new Error(`Found element with id ${n} - but was not a Template`);return e=new le(s,{}).firstElementChild,t.after(e),e}}S(Jt,"inlineCommentsSplitContainerForLine");function $e(t,e,n,s){if(t.classList.remove("color-bg-success","color-bg-danger"),s){t.textContent=e;return}if(n==="right"){t.classList.add("color-fg-success"),t.textContent=`+${e}`;return}if(n==="left"){t.classList.add("color-fg-danger"),t.textContent=`-${e}`;return}t.textContent=String(e)}S($e,"applyMultiLinePreview");const Yt={R:"right",L:"left"};function Zt(t,e){const n=ht();if(!n||n.end.is(n.start))return;if(!pt(e,n)){ge();return}const{start:{lineNumber:s},end:{lineNumber:o}}=n;let{start:{side:r},end:{side:i}}=n;const c=Number(e.getAttribute("data-line")),d=e.getAttribute("data-side");if(c!==o||!n.end.isContext()&&d!==Yt[i]){ge();return}const a=Yt[r],l=t.elements.namedItem("start_line"),m=t.elements.namedItem("start_side"),h=t.elements.namedItem("line"),y=t.elements.namedItem("side"),p=t.elements.namedItem("preview_start_side"),u=t.elements.namedItem("preview_side");if(l instanceof HTMLInputElement&&m instanceof HTMLInputElement&&h instanceof HTMLInputElement&&y instanceof HTMLInputElement&&p instanceof HTMLInputElement&&u instanceof HTMLInputElement){l.value=String(s),m.value=a,m.value=p.value=m.value,u.value=y.value;const w=l.value;r=m.value;const _=h.value;i=y.value;const F=t.closest(".js-inline-comment-form-container");if(w&&_){const T=F.querySelector(".js-multi-line-preview"),N=T.querySelector(".js-multi-line-preview-start"),As=T.querySelector(".js-multi-line-preview-end"),Ls=n.start.isContext(),qs=n.end.isContext();$e(N,w,r,Ls),$e(As,_,i,qs),T.hidden=!1,F.classList.add("is-multiline")}else F.querySelector(".js-multi-line-preview").hidden=!0,F.classList.remove("is-multiline");Fe(F)}}S(Zt,"fillMultilineFormFields");function De(t,e){const n=["type","path","position","line","side","original-line"];for(const s of n){const o=t.elements.namedItem(s);if(o instanceof HTMLInputElement){const r=e.getAttribute(`data-${s}`)||"";o.value=r}}Zt(t,e)}S(De,"fillTemplateFormFields");function ne(t,e){const n=document.getElementById(t);if(!n)throw new Error(`Could not find element with id ${t}`);if(!(n instanceof HTMLTemplateElement))throw new Error(`Found element with id ${t} - but was not a Template`);return new le(n,{anchor:e.getAttribute("data-anchor")||"",position:e.getAttribute("data-position")||"",sequence:Vn++})}S(ne,"renderCommentTemplate");var Un=Object.defineProperty,R=(t,e)=>Un(t,"name",{value:e,configurable:!0});b(".js-diff-progressive-container",function(t){Ne(t);const e=t.querySelector(".js-diff-progressive-loader");!e||e.addEventListener("load",function(){Ne(t)})});function Ne(t){const e=Ve();if(!e)return;Ue(t,e);const n=en(t,e);!n||($(n),We(n))}R(Ne,"processProgressiveContainer"),b(".js-diff-load-container",function(t){const e=t.querySelector(".js-diff-entry-loader");!e||e.addEventListener("load",function(){t.closest(".js-file").classList.remove("hide-file-notes-toggle");const s=Ve();!s||Ue(t,s)})}),f("click",".js-diff-load",function(t){if(t.target.classList.contains("js-ignore-this"))return;const e=t.currentTarget.closest(".js-diff-load-container");We(e)});function Ve(){return window.location.hash.slice(1)}R(Ve,"urlAnchor");function Ue(t,e){let n;e.match(/^diff-.+[LR]\d+-[LR]\d+/)?n=P(t.ownerDocument,e.substring(0,e.indexOf("-",5))):n=P(t.ownerDocument,e),n&&t.contains(n)&&(pe(n),$(n))}R(Ue,"scrollToAnchor");function en(t,e){const n=tn(t,e);return n||nn(t,e)}R(en,"getEntryFromAnchor");function tn(t,e){const n=/^(diff-[0-9a-f]{32})(?:[L|R]\d+)?$/.exec(e);if(!n)return;const s=n[1],o=t.querySelector(`a[name='${s}']`);if(!o)return;const r=o.nextElementSibling;if(!(r&&!r.querySelector(".js-diff-load-container")))return r}R(tn,"getEntryFromDiffAnchor");function nn(t,e){const n=/^(?:r|commitcomment-)(\d+)$/.exec(e);if(!n)return;const s=n[1],o=t.querySelector(`#diff-with-comment-${s}`);return o?o.closest(".js-file"):void 0}R(nn,"getEntryFromCommentAnchor");function We(t){const e=t.querySelector(".js-diff-entry-loader"),n=t.querySelector(".js-diff-placeholder"),s=t.querySelector("button.js-diff-load"),o=t.querySelector(".js-button-text");n.setAttribute("fill","url('#animated-diff-gradient')"),o.textContent=s.getAttribute("data-disable-with")||"",s.disabled=!0;const r=new URL(e.getAttribute("data-fragment-url")||"",window.location.origin);return e.src=r.toString(),e.data}R(We,"loadDiff");var Wn=Object.defineProperty,sn=(t,e)=>Wn(t,"name",{value:e,configurable:!0});f("click",".js-rendered, .js-source",function(t){const e=t.currentTarget;if(e.classList.contains("selected")){t.preventDefault();return}on(e),rn(e)}),C(".js-prose-diff-toggle-form",async function(t,e){const n=t.closest(".js-details-container"),s=n.querySelector(".js-file-content"),o=await e.html();for(;s.lastChild;)s.removeChild(s.lastChild);s.append(o.html),n.classList.toggle("display-rich-diff"),n.classList.toggle("show-inline-notes")});function on(t){const e=t.closest(".js-file-header"),n=t.classList.contains("js-rendered"),s=t.classList.contains("js-source"),o=e.getAttribute("data-short-path"),r=e.getAttribute("data-anchor"),i=new URL(window.location.href,window.location.origin),c=new URLSearchParams(i.search.slice(1));i.hash=r,n?c.set("short_path",o):s&&c.delete("short_path"),i.search=c.toString(),X(null,"",i.toString())}sn(on,"updateWindowLocation");function rn(t){for(const e of document.querySelectorAll(".js-rendered, .js-source"))e.classList.remove("selected"),e.removeAttribute("aria-current");t.classList.add("selected"),t.setAttribute("aria-current","true")}sn(rn,"updateSelectedButton"),f("click",".js-toc-retry",function(t){if(!(t.target instanceof Element))return;const n=t.target.closest(".select-menu").querySelector("include-fragment"),s=n.getAttribute("src");n.setAttribute("src",""),n.setAttribute("src",s)});var zn=Object.defineProperty,H=(t,e)=>zn(t,"name",{value:e,configurable:!0});function ze(t,e,n){const s=Array.from(t.querySelectorAll('[role="menuitem"]'));let o=s.indexOf(e),r=s.indexOf(n);if(o===-1)throw new Error("Couldn't find startIndex in container");if(r===-1)throw new Error("Couldn't find endItem in container");Ke(t),s[r].classList.add("is-last-in-range"),o>r&&([o,r]=[r,o]);for(const i of s.slice(o,r+1))i.classList.add("is-range-selected")}H(ze,"highlightSelectedRange");async function cn(t,e){function n(s){ze(t,e,s.target.closest('[role="menuitem"]'))}H(n,"highlightRange"),ze(t,e,e),t.addEventListener("mouseover",n),await new Promise(s=>window.addEventListener("keyup",s,{once:!0})),t.removeEventListener("mouseover",n),Ke(t)}H(cn,"observeShiftRangeHighlights");function Ke(t){for(const e of t.querySelectorAll('[role="menuitem"]'))e.classList.remove("is-range-selected","is-last-in-range")}H(Ke,"resetHighlight"),b(".js-diffbar-range-menu .js-diffbar-range-list",{subscribe:ln});function ln(t){const e=t.closest("details-menu"),n=t.classList.contains("js-diffbar-invert-range");let s=!1;function o(i){s=i.shiftKey,s&&i.preventDefault()}H(o,"clicked");function r(i){if(!s)return;i.preventDefault();const c=i.detail.relatedTarget;if(c.classList.contains("is-range-selected")){i.stopPropagation();const d=t.querySelectorAll(".is-range-selected"),a=n?d.length-1:0,l=n?0:d.length-1,m=d[a],h=d[l],y=t.getAttribute("data-range-url"),p=m.getAttribute("data-parent-commit"),u=h.getAttribute("data-commit"),w=p&&u?`${p}..${u}`:u,_=y.replace("$range",w);bt({url:_,container:document.querySelector("#js-repo-pjax-container")})}else i.stopImmediatePropagation(),cn(t,c)}return H(r,"selected"),t.addEventListener("click",o,{capture:!0}),e.addEventListener("details-menu-select",r),{unsubscribe:()=>{t.removeEventListener("click",o,{capture:!0}),e.removeEventListener("details-menu-select",r)}}}H(ln,"manageRangeHighlight"),f("toggle",".js-diffbar-range-menu",function(t){const e=t.currentTarget;if(!e.hasAttribute("open"))return;const n=e.querySelector(".in-range");n&&n.focus()},{capture:!0});const{getItem:Kn,setItem:Qn}=yt("localStorage"),an="comparison-default-tab",Xn=["commits","files","commit_comments"],Gn=["#commits_bucket","#files_bucket","#commit_comments_bucket"],Jn={files(){return[document.querySelector("[data-tab-name=files]"),document.querySelector("#files_bucket")]},commits(){return[document.querySelector("[data-tab-name=commits]"),document.querySelector("#commits_bucket")]},commit_comments(){return[document.querySelector("[data-tab-name=commit_comments]"),document.querySelector("#commit_comments_bucket")]}};b(".js-compare-tab",()=>{const t=Kn(an);if(t===null||!Xn.includes(t))return;const[e,n]=Jn[t]();if(!!(e&&n)){for(const s of document.querySelectorAll(".js-compare-tab.selected"))s.classList.remove("selected");e.classList.add("selected"),n.classList.add("selected");for(const s of document.querySelectorAll("#commits_bucket, #files_bucket, #commit_comments_bucket"))s.classList.add("d-none");n.classList.remove("d-none")}}),f("click",".js-compare-tab",function(t){for(const s of document.querySelectorAll(".js-compare-tab.selected"))s.classList.remove("selected");t.currentTarget.classList.add("selected");for(const s of document.querySelectorAll("#commits_bucket, #files_bucket, #commit_comments_bucket"))s.classList.add("d-none");const e=t.currentTarget,n=e.hash;if(n&&Gn.includes(n)){const s=e.getAttribute("data-tab-name");Qn(an,s)}document.querySelector(n).classList.remove("d-none"),t.preventDefault()}),V(function({target:t}){if(!(t instanceof HTMLElement))return;const e=t.closest("#commits_bucket, #files_bucket, #commit_comments_bucket");e&&e instanceof HTMLElement&&!he(e)&&document.querySelector(`.js-compare-tab[href="#${e.id}"]`).click()}),f("click",".js-toggle-range-editor-cross-repo",function(){document.querySelector(".js-range-editor").classList.toggle("is-cross-repo")}),f("pjax:click",".js-range-editor",function(t){const e=document.querySelector(".js-compare-pr");if(e&&e.classList.contains("open")){const n=t.detail.options,s=new URL(n.url,window.location.origin);s.search.match(/expand=1/)||(s.search+=`${s.search?"&":""}expand=1`,n.url=s.toString())}}),b(".js-compare-pr.open",{add(){document.body.classList.add("is-pr-composer-expanded")},remove(){document.body.classList.remove("is-pr-composer-expanded")}}),f("change",".js-collab-checkbox",function({currentTarget:t}){const e=t.form;for(const o of e.querySelectorAll(".errored"))o.classList.remove("errored");const s=t.closest(".js-collab-option").querySelector(".js-status-indicator");s.classList.remove("status-indicator-success","status-indicator-failed"),s.classList.add("status-indicator-loading")}),C(".js-collab-form",async function(t,e){try{await e.text()}catch(n){for(const s of t.querySelectorAll(".status-indicator-loading")){s.classList.remove("status-indicator-loading"),s.classList.add("status-indicator-failed");const o=s.closest(".js-collab-option");o.classList.add("errored");const r=o.querySelector(".js-collab-checkbox");r.checked=!r.checked}for(const s of t.querySelectorAll(".status-indicator-success"))s.classList.remove("status-indicator-success");return}for(const n of t.querySelectorAll(".errored"))n.classList.remove("errored");for(const n of t.querySelectorAll(".status-indicator-loading"))n.classList.remove("status-indicator-loading"),n.classList.add("status-indicator-success")}),f("click",".js-split-diff-view",function(){const t=document.querySelector(".js-unified-diff-view-box"),e=document.querySelector(".js-split-diff-view-box"),n=document.querySelector(".js-split-diff-view-option"),s=document.querySelector(".js-unified-diff-view-option");e.classList.add("color-border-accent-emphasis"),e.classList.remove("color-border-default"),t.classList.remove("color-border-accent-emphasis"),t.classList.add("color-border-default"),s.checked=!1,n.checked=!0}),f("click",".js-unified-diff-view",function(){const t=document.querySelector(".js-unified-diff-view-box"),e=document.querySelector(".js-split-diff-view-box"),n=document.querySelector(".js-split-diff-view-option"),s=document.querySelector(".js-unified-diff-view-option");e.classList.remove("color-border-accent-emphasis"),e.classList.add("color-border-default"),t.classList.add("color-border-accent-emphasis"),t.classList.remove("color-border-default"),s.checked=!0,n.checked=!1});var Yn=Object.defineProperty,Zn=(t,e)=>Yn(t,"name",{value:e,configurable:!0});function dn(t,e){const n=t.querySelector(".js-commit-group-commits"),s=e.querySelectorAll(".js-commit-group-commits > .js-commit");for(const r of s)r.classList.toggle("py-3"),n.appendChild(r);const o=t.querySelector(".js-commit-group-count");o instanceof HTMLElement&&(o.textContent=`${n.querySelectorAll(".js-commit").length}`),e.remove()}Zn(dn,"mergeCommitGroups"),b(".js-timeline-item > .js-commit-group",{constructor:HTMLElement,add(t){if(t.querySelector(".js-commit-group-header"))return;const e=t.closest(".js-timeline-item");if(!(e instanceof HTMLElement))return;let n=e.previousElementSibling;n instanceof HTMLElement&&(!n.classList.contains("js-timeline-item")&&(n=n.previousElementSibling,!(n instanceof HTMLElement))||!n.querySelector(".js-commit-group")||dn(n,e))}});var es=Object.defineProperty,Qe=(t,e)=>es(t,"name",{value:e,configurable:!0});f("details:toggled",".js-pull-merging",function({currentTarget:t}){const e=Array.from(t.querySelectorAll(".js-merge-pull-request")),n=e.some(he);for(const s of e)s.classList.toggle("is-dirty",n)}),f("click",".js-merge-box-try-again",async function({currentTarget:t}){const e=t.getAttribute("data-form-target");if(!["js-cleanup-branch-form","js-merge-branch-form","js-queue-branch-form","js-update-branch-form"].includes(e))return;const s=t.closest(".js-pull-merging").getElementsByClassName(e)[0];ae(s,"submit")}),document.addEventListener("session:resume",function(t){const e=document.getElementById(t.detail.targetId);if(e){const n=e.closest(".js-merge-pull-request");if(n){const s=n.closest(".js-details-container");s&&s.classList.add("open")}}}),f("change",".js-merge-button-toggle",function({currentTarget:t}){const e=t.closest(".js-merge-pr"),n=!t.checked;for(const s of e.querySelectorAll(".js-merge-commit-button"))s.disabled=n}),f("change",".js-auto-merge-admin-override",function({currentTarget:t}){const e=t.closest(".js-merge-message-container"),n=t.checked,s=e.querySelector(".js-merge-box"),o=e.querySelector(".js-auto-merge-box"),r=e.querySelector(".js-merge-form"),i=e.querySelector(".js-auto-merge-form"),c=e.querySelectorAll(".js-merge-menu-item"),d=e.querySelectorAll(".js-auto-merge-menu-item");if(s.hidden=!n,o.hidden=n,r.hidden=!n,i.hidden=n,n)for(let a=0;a<d.length;a++){const l=d[a].getAttribute("aria-checked");l!==null&&c[a].setAttribute("aria-checked",l)}else for(let a=0;a<c.length;a++){const l=c[a].getAttribute("aria-checked");l!==null&&d[a].setAttribute("aria-checked",l)}}),f("details-menu-selected",".js-update-branch-method-menu",un,{capture:!0});function un(t){const e=t.detail.relatedTarget,n=e.closest(".js-merge-pr");n.classList.toggle("is-updating-via-merge",e.value==="merge"),n.classList.toggle("is-updating-via-rebase",e.value==="rebase");const s=n.querySelector(".js-update-branch-type");s&&(s.value=e.value)}Qe(un,"updateBranchUpdateMethod"),f("submit",".js-update-branch-form",function({currentTarget:t}){var e;const n=t.closest(".js-merge-pr"),s=n==null?void 0:n.querySelector(".btn-group-update-merge");s&&(s.disabled=!0);const o=n==null?void 0:n.querySelector(".btn-group-update-rebase");o&&(o.disabled=!0);const r=n==null?void 0:n.querySelector(".js-update-method-menu-button");r&&(r.classList.add("disabled","user-select-none"),r.setAttribute("aria-disabled","true"));const i=n==null?void 0:n.querySelector(".js-update-branch-method-menu");i&&((e=i==null?void 0:i.parentNode)==null||e.removeChild(i))}),f("details-menu-selected",".js-merge-method-menu",fn,{capture:!0});function fn(t){const e=t.detail.relatedTarget,n=e.closest(".js-merge-pr"),s=n.querySelector(".js-merge-pull-request"),o=n.querySelector(".js-auto-merge-admin-override"),r=n.querySelector(".js-merge-method-menu-button"),i=r.getAttribute("data-merge-button-class");r.classList.toggle("btn-danger",e.hasAttribute("data-dangerous-action")),i&&r.classList.toggle(i,!e.hasAttribute("data-dangerous-action"));const c=n.querySelector(".js-merge-title"),d=n.querySelector(".js-merge-message");c.defaultValue===c.value&&(c.defaultValue=c.value=e.getAttribute("data-input-title-value")),d.defaultValue===d.value&&(d.defaultValue=d.value=e.getAttribute("data-input-message-value")),n.classList.toggle("is-merging",e.value==="merge"),n.classList.toggle("is-squashing",e.value==="squash"),n.classList.toggle("is-rebasing",e.value==="rebase"),n.classList.toggle("is-merging-group",e.value==="group"),n.classList.toggle("is-merging-solo",e.value==="solo"),n.classList.toggle("is-merging-jump",e.value==="jump");const a=s.classList.contains("js-admin-override-merge")&&e.value==="merge"||s.classList.contains("js-admin-override-squash")&&e.value==="squash"||s.classList.contains("js-admin-override-rebase")&&e.value==="rebase",l=n.querySelectorAll(".js-admin-override");for(const _ of l)_.hidden=!a||o!==null;const m=n.querySelector(".js-merge-type");m&&(m.value=e.value);const h=a&&!n.querySelector(".js-merge-button-toggle").checked,y=n.querySelectorAll(".js-merge-pull-request .js-merge-commit-button");for(const _ of y)_.type=e.value===_.value?"submit":"button",_.disabled=h;s.classList.toggle("color-fg-danger",a);const p=n.closest(".js-pull-merging"),u=new URL(p.getAttribute("data-url"),window.location.origin),w=new URLSearchParams(u.search);w.set("merge_type",e.value),u.search=w.toString(),p.setAttribute("data-url",u.toString())}Qe(fn,"updateForMergeMethod"),f("details:toggled",".js-merge-pr",function(t){const n=t.currentTarget.querySelector(".js-merge-message");n&&ae(n,"change")}),b(".branch-action-item.js-details-container.open",{add(t){for(const e of t.querySelectorAll(".js-merge-review-section"))e.setAttribute("open","")},remove(t){for(const e of t.querySelectorAll(".js-merge-review-section"))e.removeAttribute("open")}}),f("toggle",".js-details-container .js-merge-review-section",function({currentTarget:t}){const e=t.closest(".js-details-container"),n=e.querySelectorAll(".js-merge-review-section").length,s=e.querySelectorAll(".js-merge-review-section[open]").length;s===0?Y(e,{force:!1}):s===n&&Y(e,{force:!0})},{capture:!0}),b("poll-include-fragment[data-to-be-polled]",{constructor:ut,add(t){function e(){t.src=t.getAttribute("data-to-be-polled"),t.removeAttribute("data-to-be-polled")}Qe(e,"onVisible"),document.hidden?document.addEventListener("visibilitychange",e,{once:!0}):e()}});var ts=Object.defineProperty,ns=(t,e)=>ts(t,"name",{value:e,configurable:!0});let Xe=!1;document.addEventListener("keydown",function(t){t.key==="Alt"&&(Xe=!0)}),document.addEventListener("keyup",function(t){t.key==="Alt"&&(Xe=!1)}),f("click",".js-toggle-outdated-comments",function(t){if(!(t instanceof MouseEvent&&t.altKey||Xe)||!(t.currentTarget instanceof HTMLElement))return;const e=t.currentTarget,n=e.closest("details");function s(){const o=n.hasAttribute("open");for(const r of document.querySelectorAll(".js-toggle-outdated-comments"))r!==e&&r.closest("details").toggleAttribute("open",o)}ns(s,"toggleAll"),setTimeout(()=>{Z(e,s)})});var ss=Object.defineProperty,mn=(t,e)=>ss(t,"name",{value:e,configurable:!0});function Ge(){const t=document.querySelectorAll(".pull-request-ref-restore");for(let e=0;e<t.length;e++)t[e].classList.toggle("last",e===t.length-1)}mn(Ge,"syncLast"),b(".pull-request-ref-restore",{add:Ge,remove:Ge});function Je(){const t=document.querySelector("#js-pull-restorable")!=null,e=document.querySelector(".js-pull-discussion-timeline");e&&e.classList.toggle("is-pull-restorable",t)}mn(Je,"syncRestorable"),b("#js-pull-restorable",{add:Je,remove:Je});var os=Object.defineProperty,D=(t,e)=>os(t,"name",{value:e,configurable:!0});function gn(t,e){const n=t.closest(".js-review-state-classes"),s=document.querySelector(".js-review-changes");n.classList.toggle("is-review-pending",e>0);for(const o of document.querySelectorAll(".js-pending-review-comment-count"))o.textContent=String(e);for(const o of document.querySelectorAll(".js-pending-comment-count-type"))o instanceof HTMLElement&&(o.textContent=o.getAttribute(e===1?"data-singular-string":"data-plural-string"));if(e>0){s.textContent=s.getAttribute("data-pending-message")||"";const o=t.querySelector(".js-reviews-toggle");o.classList.add("anim-pulse-in"),o.addEventListener("animationend",()=>o.classList.remove("anim-pulse-in"),{once:!0})}else s.textContent=s.getAttribute("data-message")||""}D(gn,"updatePendingCommentsCount");function Ye(t){const e=document.querySelector(".js-reviews-container");e&&setTimeout(()=>gn(e,t))}D(Ye,"updatePendingHandler"),C(".js-inline-comment-form",async function(t,e){const n=await e.text();Ye(n.json.pendingReviewCommentsCount)}),C(".js-pending-review-comment .js-comment-delete",async function(t,e){const n=await e.text();Ye(n.json.pendingReviewCommentsCount)}),C(".js-resolvable-timeline-thread-form",async function(t,e){try{const n=await e.html();t.closest(".js-resolvable-timeline-thread-container").replaceWith(n.html)}catch(n){vt()}}),f("click",".js-resolvable-thread-toggler",function(t){t.target instanceof HTMLElement&&Ze(t.target)}),C(".js-toggle-user-reviewed-file-form",async function(t,e){const n=t.closest(".js-details-container"),s=!!n.querySelector(".js-reviewed-file"),o=n.classList.contains("open"),r=n.querySelector(".js-file-header"),i=r?r.getBoundingClientRect().top===60:!1;(!s&&o||s&&!o)&&(Y(n),i&&$(n));const c=t.querySelector(".js-reviewed-toggle");s?(c.classList.remove("color-bg-accent","color-border-accent"),c.classList.add("color-fg-muted","color-border-default")):(c.classList.remove("color-fg-muted","color-border-default"),c.classList.add("color-bg-accent","color-border-accent"));const d=c.querySelector(".js-reviewed-checkbox");d.disabled=!0;const a=document.querySelector("progress-bar");a instanceof oe&&(s?a.decrement():a.increment());const l=document.getElementById(`file-tree-item-${n.id}`);l&&l.toggleAttribute("data-file-user-viewed");const m=await e.html(),h=t.closest(".js-replace-file-header-review");h&&(h.replaceWith(m.html),n.toggleAttribute("data-file-user-viewed"))}),V(()=>{const t=window.location.hash.slice(1);if(!t)return;const e=document.getElementById(t);if(!e)return;const n=e.closest(".js-resolvable-thread-contents");n!==null&&n.classList.contains("d-none")&&Ze(e)});function Ze(t){const e=t.closest(".js-resolvable-timeline-thread-container");e.querySelector(".js-resolvable-thread-toggler-container").classList.toggle("border-bottom"),e.querySelector(".js-resolvable-thread-contents").classList.toggle("d-none");for(const s of e.querySelectorAll(".js-resolvable-thread-toggler"))s.classList.toggle("d-none")}D(Ze,"toggleResolvableThread");function se(t){return t.getAttribute("ratio").split("/")}D(se,"parseRatio");function et(t){if(t){const[e,n]=se(t),s=parseInt(e)/parseInt(n),o=t.querySelector(".js-review-progress"),r=t.querySelector(".js-review-count");o instanceof HTMLElement&&r&&(o.style.width=`${s*100}%`,r.textContent=`${e} / ${n}`)}}D(et,"refresh");class oe extends HTMLElement{static get observedAttributes(){return["ratio"]}attributeChangedCallback(e){e==="ratio"&&et(this)}connectedCallback(){et(this)}increment(){const[e,n]=se(this),s=Math.min(parseInt(e)+1,parseInt(n));this.setAttribute("ratio",`${s}/${n}`)}decrement(){const[e,n]=se(this),s=Math.min(parseInt(e)-1,parseInt(n));this.setAttribute("ratio",`${s}/${n}`)}}D(oe,"ProgressBarElement"),window.customElements.get("progress-bar")||(window.ProgressBarElement=oe,window.customElements.define("progress-bar",oe)),document.addEventListener("pjax:end",function(){for(const t of document.querySelectorAll(".js-pull-refresh-on-pjax"))St(t)}),b(".js-updating-pull-request-commits-count",{add(t){const e=t.textContent,n=document.querySelectorAll(".js-updateable-pull-request-commits-count");for(const s of n)s.textContent=e}}),(async()=>{if(await jt,window.performance&&window.performance.navigation&&window.performance.navigation.type===window.performance.navigation.TYPE_RELOAD){const t=document.getElementById("js-report-pull-request-refresh");t&&wt(t)}})();var pn=Object.defineProperty,rs=Object.defineProperties,is=Object.getOwnPropertyDescriptors,hn=Object.getOwnPropertySymbols,cs=Object.prototype.hasOwnProperty,ls=Object.prototype.propertyIsEnumerable,bn=(t,e,n)=>e in t?pn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,as=(t,e)=>{for(var n in e||(e={}))cs.call(e,n)&&bn(t,n,e[n]);if(hn)for(var n of hn(e))ls.call(e,n)&&bn(t,n,e[n]);return t},ds=(t,e)=>rs(t,is(e)),q=(t,e)=>pn(t,"name",{value:e,configurable:!0});function yn(t){const e=t.querySelector(".js-diff-entry-loader"),n=t.querySelector(".js-diff-placeholder"),s=t.querySelector("button.js-diff-load"),o=t.querySelector(".js-button-text");n.setAttribute("fill","url('#animated-diff-gradient')"),o.textContent=s.getAttribute("data-disable-with")||"",s.disabled=!0;const r=new URL(e.getAttribute("data-fragment-url")||"",window.location.origin);return e.src=r.toString(),e.data}q(yn,"loadDiff");function Q(t){pe(t),$(t)}q(Q,"scrollIntoView"),V(q(function(){const e=vn(window.location.hash);!e||P(document,e.hashFragment)&&!e.lastLine||re(e,0)},"handleHashChange"));function vn(t){if(!t)return;const e=At(t);if(!e)return;const n=e[1],s=e[2],o=e[3],r=e[5],i=n+s+o,c=n+s;return{anchor:n,side:s,line:o,lastLine:r,hashFragment:i,partialHashFragment:c}}q(vn,"parseExpansion");async function re(t,e){const{anchor:n,side:s,line:o,lastLine:r,hashFragment:i,partialHashFragment:c}=t,d=P(document,n);if(!d)return;const a=d.nextElementSibling;if(!a)return;const l=st(a,s,o,r);if(!l.length){const p=P(document,i);if(p){Q(p);return}const u=a.querySelector(".js-diff-load-container");if(!u)return;try{await yn(u);const w=P(document,i);w instanceof HTMLElement&&Q(w)}catch(w){Q(a)}return}await Sn(l,c);const m=1,h=P(document,i);st(a,s,o,r).length?re(t,e):h?Q(h):e<m&&re(t,e+1)}q(re,"findAndActivateExpander"),f("click",".js-expand",function(t){t.preventDefault(),tt(t.currentTarget)});function Sn(t,e){return Promise.all(t.map(n=>tt(n,e)))}q(Sn,"activateExpanders");async function tt(t,e){let n;if(e){const l=e.slice(-1)==="R"?"data-right-range":"data-left-range",m=t.getAttribute(l)||"",h=parseInt(m.split("-")[0],10);n=e+h}else n=t.hash.slice(1);const s=t.getAttribute("data-url"),o=new URL(s,window.location.origin),r=new URLSearchParams(o.search.slice(1));r.append("anchor",n),o.search=r.toString(),window.location.hash!==""&&window.history.replaceState(null,"","#");const i=await me(document,o.toString()),c=t.closest(".js-file");if(!c)return;const d=t.closest(".js-expandable-line"),a=nt(d,".file-diff-line");a?Z(a,()=>{d.replaceWith(i)}):d.replaceWith(i),jn(c)}q(tt,"activateExpander");function nt(t,e){const n=t.nextElementSibling;return n instanceof HTMLElement&&n.matches(e)?n:null}q(nt,"next");function st(t,e,n,s){const o=parseInt(n,10),r=parseInt(s||"",10);return Array.from(t.querySelectorAll(".js-expand")).filter(i=>{const c=e==="R"?"data-right-range":"data-left-range",d=(i.getAttribute(c)||"").split("-"),a=parseInt(d[0],10),l=parseInt(d[1],10);return a<=o&&o<=l||o<=a&&l<=r?!0:a<=r&&r<=l})}q(st,"findExpanders");function jn(t){const e=t.querySelector(".js-expand-full-wrapper");if(!e)return;Array.from(t.querySelectorAll(".js-expand")).length===0&&e.parentElement.removeChild(e)}q(jn,"removeExpandAllButton");async function wn(t,e){const n=await self.fetch(e,{headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!n.ok)throw new Error(`Request to blob_expand failed with status code ${n.status}`);return Lt(qt(t),n,!0),(await n.json()).map(o=>ds(as({},o),{content:J(t,o.content)}))}q(wn,"fetchManySafeDocumentFragments"),f("click",".js-expand-full",async t=>{t.preventDefault();const e=t.currentTarget,n=e.closest(".file"),s=e.getAttribute("data-url"),o=Ln(n);if(o.length===0)return;const r=new URL(s,window.location.origin),i=new URLSearchParams(r.search.slice(1));for(const l of o)i.append("ranges[]last_left",l.left.start),i.append("ranges[]left",l.left.end),i.append("ranges[]left_hunk_size",l.left.size),i.append("ranges[]last_right",l.right.start),i.append("ranges[]right",l.right.end),i.append("ranges[]right_hunk_size",l.right.size),i.append("ranges[]position",l.position);r.search=i.toString();const c=await wn(document,r.toString()),d=[...n.querySelectorAll(".js-expand")];for(const{content:l,position:m}of c){const h=parseInt(m,10),y=d[h];if(!y)return;const p=y.closest(".js-expandable-line"),u=nt(p,".file-diff-line");u?Z(u,()=>{p.after(l)}):p.after(l),p.setAttribute("hidden","true")}e.setAttribute("hidden","true");const a=n.querySelector(".js-collapse-diff");a&&a.removeAttribute("hidden"),n.classList.add("open"),n.classList.add("Details--on")}),f("click",".js-collapse-diff",t=>{const e=t.currentTarget,n=e.closest(".file"),s=[...n.querySelectorAll('.blob-expanded[data-expanded-full="true"]')];for(const i of s)i.parentElement.removeChild(i);const o=[...n.querySelectorAll(".js-expandable-line")];for(const i of o)i.removeAttribute("hidden");e.setAttribute("hidden","true");const r=n.querySelector(".js-expand-full");r&&r.removeAttribute("hidden")});function An(t,e){const s=new URL(t.getAttribute("data-url"),window.location.origin).searchParams;return{position:e.toString(),left:{start:s.get("last_left"),end:s.get("left"),size:s.get("left_hunk_size")},right:{start:s.get("last_right"),end:s.get("right"),size:s.get("right_hunk_size")}}}q(An,"getExpanderRange");function Ln(t){const n=Array.from(t.querySelectorAll(".js-expand")).map((r,i)=>An(r,i));let s=!1;const o=[];for(let r=0;r<n.length;r++){if(s){s=!1;continue}const i=n[r],c=n[r+1];s=c&&i.left.start===c.left.start&&i.left.end===c.left.end&&i.right.start===c.right.start&&i.right.end===c.right.end,o.push(i)}return o}q(Ln,"getAllHunkRanges");var us=Object.defineProperty,fs=(t,e)=>us(t,"name",{value:e,configurable:!0});class ie{constructor(e){this.selection=e,this.anchorNode=e.anchorNode}range(){var e;let n;return((e=this.selection)==null?void 0:e.rangeCount)>0&&(n=this.selection.getRangeAt(0)),n}canBeSideProtected(){try{return!!(this.hasSelectedText()&&this.confinedTable())}catch(e){return!1}}isSideProtected(){var e;try{return!!((e=this.confinedTable())==null?void 0:e.getAttribute("data-lock-side-selection"))}catch(n){return!1}}hasSelectedText(){const e=this.range();return e?e.toString().length>0:!1}clearSelectedText(){this.selection.removeAllRanges()}confinedTable(){var e,n;const s=(n=(e=this.range())==null?void 0:e.commonAncestorContainer)==null?void 0:n.parentElement;return(s==null?void 0:s.matches(".diff-table"))?s:(s==null?void 0:s.matches(".js-file-content"))?s==null?void 0:s.querySelector("table.diff-table"):s==null?void 0:s.closest("table.diff-table")}unprotectedSide(){var e,n;let s;return this.anchorNode instanceof HTMLTableCellElement?s=this.anchorNode.closest("td[data-split-side]"):s=(n=(e=this.anchorNode)==null?void 0:e.parentElement)==null?void 0:n.closest("td[data-split-side]"),s==null?void 0:s.getAttribute("data-split-side")}protectedSide(){return this.unprotectedSide()==="left"?"right":"left"}applySideProtection(){if(this.unprotectedSide()){const e=this.confinedTable(),n=this.unprotectedSide();e&&n&&e.setAttribute("data-lock-side-selection",n)}}clearSideProtection(){const e=document.querySelectorAll("table[data-lock-side-selection]");for(const n of e)n.removeAttribute("data-lock-side-selection")}filteredTableRows(){const e=[];for(let n=0;n<this.selection.rangeCount;n++){const o=this.selection.getRangeAt(n).cloneContents();if(o.querySelectorAll("td").length){const r=`td[data-split-side=${this.protectedSide()}], td.js-linkable-line-number, td.empty-cell`,i=o.querySelectorAll(r);for(const c of i)c.parentNode&&c.parentNode.removeChild(c);e.push(...o.children)}else{const r=document.createElement("TR"),i=document.createElement("TD");i.append(...o.childNodes),r.append(i),e.push(r)}}return e}contentToString(){var e;const n=[],s=document.createElement("table");s.classList.add("invisible"),s.append(...this.filteredTableRows()),(e=this.confinedTable())==null||e.append(s);const o=s.children;for(let r=0;r<o.length;r++){const c=o[r].innerText;c&&(c===`
`?n.push(""):n.push(c))}return s.remove(),n.join(`
`)}}fs(ie,"DiffTableSideProtection");var ms=Object.defineProperty,x=(t,e)=>ms(t,"name",{value:e,configurable:!0});function ot(t){return Math.floor(t/2)}x(ot,"tableSide");function ce(t,e){const n=t.parentElement;if(!n)return;const s=n.children;let o;if(s.length===4)for(let r=0,i=s.length;r<i;r++)s[r]===t&&(o=ot(r));for(let r=0,i=s.length;r<i;r++){const c=s[r];(o==null||ot(r)===o)&&c.classList.toggle("is-hovered",e)}}x(ce,"onHover"),b(".diff-table",function(t){let e=null;function n(){e&&ce(e,!1),e=null}x(n,"onMouseEnter");function s(i){e&&ce(e,!1),i.target instanceof HTMLElement&&(e=i.target.closest("td.blob-code"),e&&ce(e,!0))}x(s,"onMouseOver");function o(){t.addEventListener("mouseenter",n),t.addEventListener("mouseleave",n),t.addEventListener("mouseover",s)}x(o,"add");function r(){t.removeEventListener("mouseenter",n),t.removeEventListener("mouseleave",n),t.removeEventListener("mouseover",s)}return x(r,"remove"),{add:o,remove:r}});function rt(t){var e;const n=document.getSelection();if(n){const s=new ie(n);s.isSideProtected()&&((e=t.clipboardData)==null||e.setData("text/plain",s.contentToString()),t.preventDefault())}}x(rt,"copySidedContent");function it(t){const e=document.getSelection(),n=t.button===2;if(e&&!n){const s=new ie(e);s.isSideProtected()&&(s.clearSelectedText(),s.clearSideProtection())}}x(it,"clearSidedProtection");function ct(){const t=document.getSelection();if(t){const e=new ie(t);e.canBeSideProtected()?e.applySideProtection():e.clearSideProtection()}}x(ct,"protectSidedContent"),b(".js-diff-container",function(){function t(){document.addEventListener("copy",rt),document.addEventListener("mousedown",it),document.addEventListener("selectionchange",ct)}x(t,"add");function e(){document.removeEventListener("copy",rt),document.removeEventListener("mousedown",it),document.removeEventListener("selectionchange",ct)}return x(e,"remove"),{add:t,remove:e}});var gs=Object.defineProperty,ps=(t,e)=>gs(t,"name",{value:e,configurable:!0});function k(){const t=document.querySelector("meta[name=diff-view]"),e=t&&t instanceof HTMLMetaElement?t.content:"",n=document.querySelector(".js-file-diff-split"),s=!!(e==="split"&&n||document.querySelector(".wants-full-width-container"));document.body.classList.toggle("full-width",s)}ps(k,"syncBodyClass"),b("meta[name=diff-view]",{add:k,remove:k}),b(".js-file-diff-split",{add:k,remove:k}),b(".js-compare-tab.selected",{add:k,remove:k}),b(".wants-full-width-container",{add:k,remove:k});var hs=Object.defineProperty,qn=(t,e)=>hs(t,"name",{value:e,configurable:!0});f("change",".js-toggle-file-notes",function(t){const e=t.currentTarget;e.closest(".file").classList.toggle("show-inline-notes",e.checked)});function lt(t){const e=t.some(n=>n.checked);for(const n of t)U(n,!e)}qn(lt,"toggleCheckboxes"),f("click",".js-toggle-all-file-notes",function(t){const e=Array.from(document.querySelectorAll(".js-toggle-file-notes"));lt(e),t.preventDefault()}),f("click",".js-toggle-all-file-annotations",function(t){const e=Array.from(document.querySelectorAll(".js-toggle-file-check-annotations"));lt(e),t.preventDefault()}),b(".js-inline-comments-container",function(t){let e;const n=t.closest(".file");if(n)return{add:e=qn(function(){const o=n.querySelector(".js-inline-comments-container")!=null;n.classList.toggle("has-inline-notes",o)},"remove"),remove:e}}),f("change",".js-toggle-file-check-annotations",function(t){const e=t.currentTarget,n=e.closest(".file").querySelectorAll(".js-inline-annotations");for(const s of n)s instanceof HTMLElement&&(s.hidden=!e.checked)});var bs=Object.defineProperty,ys=(t,e)=>bs(t,"name",{value:e,configurable:!0});function at(t){const e=t.parentElement,n=e.querySelectorAll("td.js-line-comments").length,s=e.querySelectorAll("td.js-line-comments.is-collapsed").length;e.classList.toggle("is-collapsed",s>0&&n===s)}ys(at,"updateRow"),b("td.js-line-comments.is-collapsed",{add:at,remove:at});var _n=Object.defineProperty,vs=Object.getOwnPropertyDescriptor,Ss=(t,e)=>_n(t,"name",{value:e,configurable:!0}),A=(t,e,n,s)=>{for(var o=s>1?void 0:s?vs(e,n):e,r=t.length-1,i;r>=0;r--)(i=t[r])&&(o=(s?i(e,n,o):i(o))||o);return s&&o&&_n(e,n,o),o};let j=class extends HTMLElement{connectedCallback(){this.observer=b(".js-file-filter",()=>{this.updateFilterState(),this._showBlankslateIfEmpty(),this._updateUrl()})}disconnectedCallback(){this.observer&&this.observer.abort()}updateFilterState(){this._activateFilterHighlight(),this._toggleSelectAll(),this._toggleFileTypeCounts(),this._toggleAvailableOptions()}filterFiles(t){for(const e of this.diffEntries){const n=e.closest(".js-file.js-details-container");n.hidden=!this._shouldShowFile(e)}this._showBlankslateIfEmpty(),this._instrumentFilterToggle(t),this._updateUrl()}filterTreeFiles(){for(const t of this.treeEntries){const e=this._shouldShowFile(t);t.hidden=!e,t.toggleAttribute("data-skip-substring-filter",!e)}}enableAllFileInputs(){if(!!this._fileTypeFilterActive())for(const t of this.fileExtensions)t.checked=!0}_activateFilterHighlight(){this._filtersActive()?(this.fileFilterActiveText.classList.toggle("color-fg-accent",!0),this.resetFilters!=null&&(this.resetFilters.hidden=!1)):(this.fileFilterActiveText.classList.toggle("color-fg-accent",!1),this.resetFilters!=null&&(this.resetFilters.hidden=!0))}_toggleSelectAll(){const t=this._fileTypeFilterActive(),e=this._fileTypeFilterActive()?"data-select-all-markup":"data-all-selected-markup",n=this.selectAllContainer.getAttribute(e);this.selectAllContainer.textContent=n,this.selectAllContainer.classList.toggle("color-fg-muted",!t),this.selectAllContainer.classList.toggle("color-fg-accent",t)}_toggleFileTypeCounts(){for(const t of this.fileTypeCount){const e=this._shouldHideDeletedFiles()?"data-non-deleted-file-count-markup":"data-all-file-count-markup",n=t.getAttribute(e);n&&(t.textContent=n)}}_toggleAvailableOptions(){for(const t of this.fileExtensions)if(this._shouldHideDeletedFiles()){const e=t.getAttribute("data-non-deleted-files-count")==="0";t.disabled=e}else t.disabled=!1}_shouldShowFile(t){let e=!0;const n=t.getAttribute("data-file-type");return n&&(e=this._selectedFileTypes().includes(n)),this._shouldHideViewedFiles()&&e&&t.hasAttribute("data-file-user-viewed")&&(e=!1),this._shouldShowOwnedFilesOnly()&&e&&(e=(t.getAttribute("data-codeowners")||"").split(",").filter(o=>this._selectedOwners().includes(o)).length>0),this._shouldHideDeletedFiles()&&e&&t.getAttribute("data-file-deleted")==="true"&&(e=!1),this._shouldShowManifestFilesOnly()&&e&&(t.hasAttribute("data-file-manifest")||(e=!1)),e}_showBlankslateIfEmpty(){if(!this.blankslate)return;if(this.progressiveLoaders.length>0){this.blankslate.hidden=!0;return}if(this.diffEntries.length===0){this.blankslate.hidden=!0;return}const t=Array.from(this.diffEntries).some(e=>!e.hidden);this.blankslate.hidden=t}_instrumentFilterToggle(t){const e=t.currentTarget,s={file_filter_checked:e.checked};e.setAttribute("data-hydro-client-context",JSON.stringify(s)),_t(e)}_updateUrl(){be(this._fileTypeFilterActive(),this._whitespaceFilterActive(),this._selectedFileTypes(),this._shouldShowOwnedFilesOnly(),this._selectedOwners(),this._shouldShowManifestFilesOnly(),this._shouldHideDeletedFiles(),this._shouldHideViewedFiles())}_filtersActive(){return this._fileTypeFilterActive()||this._shouldShowOwnedFilesOnly()||this._shouldHideDeletedFiles()||this._shouldHideViewedFiles()||this._shouldShowManifestFilesOnly()}_fileTypeFilterActive(){return this._selectedFileTypes().length!==this.fileExtensions.length}_whitespaceFilterActive(){return new URLSearchParams(window.location.search).has("w")}_selectedFileTypes(){return Array.from(this.fileExtensions).filter(e=>e.checked).map(e=>e.value)}_shouldShowOwnedFilesOnly(){return this._selectedOwners().length>0}_selectedOwners(){return this.codeownersFilterInputs?Array.from(this.codeownersFilterInputs).filter(e=>e.checked).map(e=>e.value):[]}_shouldShowManifestFilesOnly(){return!!this.manifestFilesInput&&this.manifestFilesInput.checked}_shouldHideDeletedFiles(){return!!this.deletedFilesInput&&!this.deletedFilesInput.checked}_shouldHideViewedFiles(){return!this.viewedFilesInput.checked}};Ss(j,"DiffFileFilterElement"),A([I],j.prototype,"blankslate",2),A([I],j.prototype,"deletedFilesInput",2),A([I],j.prototype,"manifestFilesInput",2),A([I],j.prototype,"viewedFilesInput",2),A([M],j.prototype,"codeownersFilterInputs",2),A([M],j.prototype,"fileExtensions",2),A([I],j.prototype,"selectAllContainer",2),A([I],j.prototype,"fileFilterActiveText",2),A([I],j.prototype,"resetFilters",2),A([M],j.prototype,"fileTypeCount",2),A([M],j.prototype,"diffEntries",2),A([M],j.prototype,"progressiveLoaders",2),A([M],j.prototype,"treeEntries",2),j=A([de],j);var xn=Object.defineProperty,js=Object.getOwnPropertyDescriptor,Cn=(t,e)=>xn(t,"name",{value:e,configurable:!0}),ws=(t,e,n,s)=>{for(var o=s>1?void 0:s?js(e,n):e,r=t.length-1,i;r>=0;r--)(i=t[r])&&(o=(s?i(e,n,o):i(o))||o);return s&&o&&xn(e,n,o),o};class Tn{onItemSelected(e){if(!(e.currentTarget instanceof HTMLButtonElement))return;const n=e.currentTarget.querySelector(".js-ref-name").textContent,s=document.querySelector(".js-new-base-branch");s.value=btoa(n||"");const o=document.querySelector(".js-change-base-template").content.cloneNode(!0);o instanceof DocumentFragment&&xt({content:o})}}Cn(Tn,"InputDemuxBaseChangeContext");let dt=class extends HTMLElement{connectedCallback(){const t=this.getAttribute("data-context-type"),e={baseChange:new Tn};this.context=e[t]}onItemSelected(t){this.context.onItemSelected(t)}};Cn(dt,"InputDemuxContextWrapperElement"),dt=ws([de],dt)}}});
//# sourceMappingURL=diffs-82d55288.js.map
